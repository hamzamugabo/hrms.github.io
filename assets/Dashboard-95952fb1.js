import{r as i,w as L,o as M,a as I,b as C,c as O,d as D,e as J,u as de,f as B,s as me,g as e,_ as se,h as ve,i as W,j as Y,t as j,k as q,l as ye,S as pe,F as ee,m as _e,n as be,p as he,q as ne,v as ce,x as E,y as re,z as ie,A as te,B as ge,C as ue,D as fe,E as ae,G as oe,H as le}from"./index-e8eb3072.js";const xe={class:"card"},Ce={__name:"EmployeesPerDepartmentBar",props:["label","lables","data"],setup(s){const o=s,u=i({}),f=i({}),v=()=>{const l=o==null?void 0:o.lables,k=o==null?void 0:o.data;return{labels:l,datasets:[{label:o==null?void 0:o.label,data:k,backgroundColor:["rgba(249, 115, 22, 0.2)","rgba(6, 182, 212, 0.2)","rgba(107, 114, 128, 0.2)","rgba(139, 92, 246, 0.2)"],borderColor:["rgb(249, 115, 22)","rgb(6, 182, 212)","rgb(107, 114, 128)","rgb(139, 92, 246)"],borderWidth:1}]}},t=()=>{const l=getComputedStyle(document.documentElement),k=l.getPropertyValue("--text-color"),A=l.getPropertyValue("--text-color-secondary"),b=l.getPropertyValue("--surface-border");return{plugins:{legend:{labels:{color:k}}},scales:{x:{ticks:{color:A},grid:{color:b}},y:{beginAtZero:!0,ticks:{color:A,min:1,stepSize:1,callback:function(T){if(Number.isInteger(T))return T}},grid:{color:b}}}}};return L(()=>o.data,(l,k)=>{l!==k&&(u.value=v(),f.value=t())}),M(async()=>{u.value=v(),f.value=t()}),(l,k)=>{const A=I("Chart");return C(),O("div",xe,[D(A,{type:"bar",data:u.value,options:f.value},null,8,["data","options"])])}}},ke={class:"card"},Ae={key:1},De={__name:"AttendenceTimeFramesLineGraph",props:["attendanceFrame","url","chartDataObject"],setup(s){const o=s;console.log("url",o==null?void 0:o.url);const u=i(null),f=i({scales:{y:{beginAtZero:!0}}}),v=async()=>{try{const{data:t}=await B(o==null?void 0:o.url,!1);console.log("data from att",t),u.value={labels:t==null?void 0:t.map(l=>l.date),datasets:[{label:"Average Break Duration",backgroundColor:"#4CAF50",borderColor:"#4CAF50",data:t==null?void 0:t.map(l=>l.averageBreakDuration),fill:!1},{label:"Total Attendance",backgroundColor:"#db0000",borderColor:"#db0000",data:t==null?void 0:t.map(l=>l.totalAttendance),fill:!1},{label:"Average Overtime Duration",backgroundColor:"#cbd5e1",borderColor:"#cbd5e1",data:t==null?void 0:t.map(l=>l.averageOvertimeDuration),fill:!1}]}}catch(t){console.error("Error fetching data:",t)}};return M(()=>{v()}),L(()=>o.attendanceFrame,(t,l)=>{t!==l&&v()}),L(()=>o.url,(t,l)=>{t!==l&&v()}),(t,l)=>(C(),O("div",ke,[u.value?(C(),J(de(me),{key:0,type:"line",data:u.value,options:f.value},null,8,["data","options"])):(C(),O("div",Ae,"Loading..."))]))}},$e={class:"card"},we={__name:"AttendenceTimeFramesBarLIne",props:["attendanceFrame","url","chartDataObject"],setup(s){const o=s;console.log("url",o==null?void 0:o.url);const u=i(null),f=i({scales:{y:{beginAtZero:!0}},elements:{bar:{barPercentage:.1,categoryPercentage:.1}}}),v=async()=>{try{const{data:t}=await B(o==null?void 0:o.url,!1);console.log("data from att",t),u.value={labels:t==null?void 0:t.map(l=>l.date),datasets:[{label:"Average Break Duration",backgroundColor:"#4CAF50",borderColor:"#4CAF50",data:t==null?void 0:t.map(l=>l.averageBreakDuration),fill:!1},{label:"Total Attendance",backgroundColor:"#db0000",borderColor:"#db0000",data:t==null?void 0:t.map(l=>l.totalAttendance),fill:!1},{label:"Average Overtime Duration",backgroundColor:"#cbd5e1",borderColor:"#cbd5e1",data:t==null?void 0:t.map(l=>l.averageOvertimeDuration),fill:!1}]}}catch(t){console.error("Error fetching data:",t)}};return M(()=>{v()}),L(()=>o.attendanceFrame,(t,l)=>{t!==l&&v()}),L(()=>o.url,(t,l)=>{t!==l&&v()}),(t,l)=>{const k=I("Chart");return C(),O("div",$e,[D(k,{type:"bar",data:u.value,options:f.value},null,8,["data","options"])])}}};const je={class:"col-12 xl:col-6"},Pe={class:"card"},Se={__name:"WeeklyAttendance",props:["attendanceData"],setup(s){const o=s,u=i({labels:Object.keys(o==null?void 0:o.attendanceData),datasets:[{label:"On Time",backgroundColor:"#4CAF50",borderColor:"#4CAF50",data:Object.values(o==null?void 0:o.attendanceData).map(v=>v.onTimeCount)},{label:"Late",backgroundColor:"#FFA726",borderColor:"#FFA726",data:Object.values(o==null?void 0:o.attendanceData).map(v=>v.lateCount)},{label:"Absent",backgroundColor:"#db0000",borderColor:"#db0000",data:Object.values(o==null?void 0:o.attendanceData).map(v=>v.absentCount)}]}),f=i({responsive:!0,maintainAspectRatio:!1,scales:{x:{title:{display:!0,text:"Date"}},y:{title:{display:!0,text:"Count"},beginAtZero:!0,ticks:{stepSize:1,precision:0}}}});return L(()=>o.attendanceData,v=>{u.value.labels=Object.keys(v),u.value.datasets[0].data=Object.values(v).map(t=>t.onTimeCount),u.value.datasets[1].data=Object.values(v).map(t=>t.lateCount),u.value.datasets[2].data=Object.values(v).map(t=>t.absentCount)},{immediate:!0}),(v,t)=>{const l=I("Chart");return C(),O("div",je,[e("div",Pe,[D(l,{type:"bar",data:u.value,options:f.value},null,8,["data","options"])])])}}};const z=s=>(ne("data-v-71c86bdf"),s=s(),ce(),s),Te={class:"flex justify-content-end gap-2"},Fe={class:"col-12 xl:col-6"},Ee={class:"card"},Oe=z(()=>e("h6",null,"Payroll summary",-1)),Be={class:"flex justify-around"},Ie={class:"flex justify-center items-center div-button mr-1"},Le={class:"text-xs font-bold mr-1 text-red-500"},Ve=z(()=>e("span",{class:"text-xs text-red-500"},"Total Amount",-1)),Ue={class:"flex justify-center items-center div-button mr-1"},Re={class:"text-xs font-bold mr-1 text-green-500"},qe=z(()=>e("span",{class:"text-xs text-green-500"},"Payrolls",-1)),Me={class:"flex justify-center items-center div-button"},Ne={class:"text-xs font-bold mr-1 text-blue-500"},Je=z(()=>e("span",{class:"text-xs text-blue-500"},"Average Amount",-1)),ze=z(()=>e("h5",null,"Add Employee Payroll",-1)),He={class:"flex justify-between items-center mb-4"},We={class:"flex items-center space-x-2"},Ze=z(()=>e("i",{class:"pi pi-search"},null,-1)),Ke={class:"overflow-y-auto",style:{"max-height":"300px"}},Ge={class:"list-none p-0"},Qe={class:"flex-1"},Xe={class:"block"},Ye={__name:"AddEmployeePayroll",props:{employees:{type:Array,required:!0},employeeSearch:{type:String,default:""}},emits:["update:employeeSearch"],setup(s,{emit:o}){const u=s,f=i({}),{getPayrollSummary:v}=be();M(async()=>{await v(f,!1)});const t=i(""),l=i(!1),k=i(""),A=i(!1),b=i(!1),T=i({}),V=i({}),P=async()=>{var _;A.value=!0;const g=`${E}/payrolls/create`;if(!((_=T==null?void 0:T.value)!=null&&_.salaryId)){t.value="Add Employee's salary first",A.value=!1;return}try{const h={...T.value};console.log("submit",h);const p=await he(g,h);(p==null?void 0:p.status)===200||(p==null?void 0:p.status)===201?(l.value=!0,k.value=p==null?void 0:p.message,A.value=!1):(t.value=(p==null?void 0:p.error)||(p==null?void 0:p.message),A.value=!1)}catch(h){t.value=(h==null?void 0:h.message)||(h==null?void 0:h.message),A.value=!1,console.log(h==null?void 0:h.error)}},d=o,m=i(u==null?void 0:u.employeeSearch),a=ve(()=>m.value.trim()===""?u==null?void 0:u.employees:u==null?void 0:u.employees.filter(g=>g.name.toLowerCase().includes(m.value.toLowerCase()))),r=()=>{d("update:employeeSearch",m.value)},n=g=>{console.log(`Creating payroll for ${g}`),V.value=g,b.value=!0};L(()=>u.employeeSearch,g=>{m.value=g});const x=g=>{T.value=g};return(g,_)=>{var R,H,y;const h=I("Message"),p=I("Button"),U=I("Dialog"),N=I("InputIcon"),Z=I("InputText"),K=I("IconField");return C(),O(ee,null,[D(U,{visible:b.value,"onUpdate:visible":_[2]||(_[2]=c=>b.value=c),header:"Create Payroll",style:{width:"50rem"}},{default:W(()=>[l.value?(C(),J(h,{key:0,severity:"success"},{default:W(()=>[Y(j(k.value),1)]),_:1})):q("",!0),t.value?(C(),J(h,{key:1,severity:"error"},{default:W(()=>[Y(j(t.value),1)]),_:1})):q("",!0),D(ye,{onHandleCreateEmployeePayroll:x,employee:V.value},null,8,["employee"]),e("div",Te,[D(p,{type:"button",label:"Cancel",severity:"secondary",onClick:_[0]||(_[0]=c=>b.value=!1)}),A.value?q("",!0):(C(),J(p,{key:0,type:"button",label:"Submit",onClick:_[1]||(_[1]=c=>P())})),D(pe,{loading:A.value,size:"3rem"},null,8,["loading"])])]),_:1},8,["visible"]),e("div",Fe,[e("div",Ee,[Oe,e("div",Be,[e("div",Ie,[e("span",Le,j((R=f.value)==null?void 0:R.totalAmountPaid),1),Ve]),e("div",Ue,[e("span",Re,j((H=f.value)==null?void 0:H.numberOfPayrolls),1),qe]),e("div",Me,[e("span",Ne,j((y=f.value)==null?void 0:y.averagePayrollAmount),1),Je])]),ze,e("div",He,[e("div",We,[D(K,{iconPosition:"left"},{default:W(()=>[D(N,null,{default:W(()=>[Ze]),_:1}),D(Z,{modelValue:m.value,"onUpdate:modelValue":_[3]||(_[3]=c=>m.value=c),placeholder:"Keyword Search",onInput:r},null,8,["modelValue"])]),_:1})])]),e("div",Ke,[e("ul",Ge,[(C(!0),O(ee,null,_e(a.value,c=>(C(),O("li",{key:c.id,class:"flex justify-between items-center border-b py-2"},[e("div",Qe,[e("span",Xe,j(c.name),1)]),D(p,{label:c.payroll.length>0?"Add Payroll":"Create Payroll",class:"p-button-sm p-button-primary ml-2",onClick:$=>n(c)},null,8,["label","onClick"])]))),128))])])])])],64)}}},et=se(Ye,[["__scopeId","data-v-71c86bdf"]]),tt=()=>{const s=i(!1),o=async d=>{var r;const m=(r=re())==null?void 0:r.accessToken,a=`${ue}/validate/${m}`;try{if(m){const n=await ie(a,s,d);return console.log("token validation","status=>",n==null?void 0:n.status,"okay==>",n==null?void 0:n.ok),n}else return d.push("/auth/login"),console.log("no access token"),"Token not available"}catch{}},u=async d=>{const m=`${E}/payrolls/by-employeeId/${d}`;try{const{data:a}=await B(m,s);return a||[]}catch(a){console.log("employee payroll error",a)}};return{getEmployeePayroll:u,getEmployees:async(d,m)=>{const a=`${E}/employees`;s.value=!0;try{const{data:r}=await B(a,s),n=await Promise.all(r.map(async x=>({...x,name:`${x.firstName} ${x.lastName}`,payroll:await u(x==null?void 0:x.id)})));d.value=n,m.value=n}catch(r){console.log("employees error",r)}finally{s.value=!1}},getEmployeesPerDepartment:async(d,m,a)=>{const r=`${E}/employees/distribution/department`;s.value=!0;try{const{data:n}=await B(r,s,a);console.log("employees per department",n),m.value=n==null?void 0:n.map(x=>x.departmentName),d.value=n==null?void 0:n.map(x=>x.employeeCount)}catch(n){console.log("employees per department error",n)}finally{s.value=!1}},getJobs:async d=>{const m=`${E}/job-posting`;s.value=!0;try{const{data:a}=await B(m,s);d.value=a==null?void 0:a.length}catch(a){console.log("Job posting error",a)}finally{s.value=!1}},getAttendanceMonthlyFrames:async(d,m)=>{var r;const a=`${E}/attendance/trends/${(r=m==null?void 0:m.value)==null?void 0:r.name}`;s.value=!0;try{const{data:n}=await B(a,s);d.value=n}catch(n){console.log("Attendance monthly frames error",n)}finally{s.value=!1}},fetchDataTimeFrameAttendance:async(d,m)=>{try{const{data:a}=await B(d.value,!1);console.log("data from att",a),m.value={labels:a==null?void 0:a.map(r=>r.date),datasets:[{label:"Average Break Duration",borderColor:"#42A5F5",data:a==null?void 0:a.map(r=>r.averageBreakDuration),fill:!1},{label:"Total Attendance",borderColor:"#66BB6A",data:a==null?void 0:a.map(r=>r.totalAttendance),fill:!1},{label:"Average Overtime Duration",borderColor:"#FFA726",data:a==null?void 0:a.map(r=>r.averageOvertimeDuration),fill:!1}]}}catch(a){console.error("Error fetching data:",a)}},getRequests:async d=>{const m=`${E}/leave/request`;s.value=!0;try{const{data:a}=await B(m,s);d.value=a==null?void 0:a.length}catch(a){console.error("Error fetching requests:",a)}finally{s.value=!1}},getAttenceMonthlyFrames:async(d,m)=>{var r;const a=`${E}/attendance/trends/${(r=d==null?void 0:d.value)==null?void 0:r.name}`;s.value=!0;try{const{data:n}=await B(a,s);console.log("===>",n),s.value=!1,m.value=n}catch(n){s.value=!1,console.log("Job posting error",n)}},applyLightTheme:d=>{d.value={plugins:{legend:{labels:{color:"#495057"}}},scales:{x:{ticks:{color:"#495057"},grid:{color:"#ebedef"}},y:{ticks:{color:"#495057"},grid:{color:"#ebedef"}}}}},applyDarkTheme:d=>{d.value={plugins:{legend:{labels:{color:"#ebedef"}}},scales:{x:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}},y:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}}}}},getAttendanceSummary:async(d,m,a)=>{try{const r={startDate:te(d),endDate:te(m)};let n=`${E}/attendance/summary/daily`;const x=new URLSearchParams(r).toString();n+=`?${x}`;const{data:g}=await ge(n,s);console.log("daily Attendance",g),a.value=g}catch(r){console.log(r)}},tokenAuthValidation:o}};const w=s=>(ne("data-v-07a1986f"),s=s(),ce(),s),at={class:"grid"},ot={class:"card mb-0"},lt={class:"flex justify-content-between mb-3"},st=w(()=>e("span",{class:"block text-500 font-medium mb-3"},"Employees",-1)),nt={class:"text-900 font-medium text-xl"},ct=w(()=>e("div",{class:"flex align-items-center justify-content-center bg-blue-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-user text-blue-500 text-xl"})],-1)),rt={class:"card mb-0"},it={class:"flex justify-content-between mb-3"},ut=w(()=>e("span",{class:"block text-500 font-medium mb-3"},"Leave Requests",-1)),dt={class:"text-900 font-medium text-xl"},mt=w(()=>e("div",{class:"flex align-items-center justify-content-center bg-orange-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-bell text-orange-500 text-xl"})],-1)),vt={class:"card mb-0"},yt={class:"flex justify-content-between mb-3"},pt=w(()=>e("span",{class:"block text-500 font-medium mb-3"},"Job Posts",-1)),_t={class:"text-900 font-medium text-xl"},bt=w(()=>e("div",{class:"flex align-items-center justify-content-center bg-cyan-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-briefcase text-cyan-500 text-xl"})],-1)),ht={key:0,class:"text-green-500 font-medium"},gt={key:1,class:"text-500"},ft={class:"card mb-0"},xt=w(()=>e("div",{class:"flex justify-content-between mb-3"},[e("div",null,[e("span",{class:"block text-500 font-medium mb-3"},"Attendance")]),e("div",{class:"flex align-items-center justify-content-center bg-cyan-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-briefcase text-cyan-500 text-xl"})])],-1)),Ct={class:"flex justify-around"},kt={class:"flex justify-center items-center mr-1"},At={class:"text-xs font-bold mr-1 text-red-500"},Dt=w(()=>e("span",{class:"text-xs text-red-500"},"On Time",-1)),$t={class:"flex justify-center items-center mr-1"},wt={class:"text-xs font-bold mr-1 text-green-500"},jt=w(()=>e("span",{class:"text-xs text-green-500"},"Late",-1)),Pt={class:"flex justify-center items-center"},St={class:"text-xs font-bold mr-1 text-blue-500"},Tt=w(()=>e("span",{class:"text-xs text-blue-500"},"Absent",-1)),Ft={class:"col-12 xl:col-6"},Et={class:"card"},Ot=w(()=>e("h5",null,"Employees per department Bar",-1)),Bt={class:"col-12 xl:col-6"},It={class:"card"},Lt={class:"flex"},Vt=w(()=>e("h5",null,"Employees attendance",-1)),Ut={class:"flex mb-5"},Rt=w(()=>e("label",{for:"bar"},"Bar",-1)),qt={class:"ml-2"},Mt=w(()=>e("label",{for:"line"},"Line",-1)),Nt={__name:"Dashboard",setup(s){const{getEmployees:o,getEmployeesPerDepartment:u,getJobs:f,fetchDataTimeFrameAttendance:v,getRequests:t,getAttenceMonthlyFrames:l,getAttendanceSummary:k,tokenAuthValidation:A}=tt(),b=fe(),T=async()=>{var $;const y=($=re())==null?void 0:$.accessToken,c=`${ue}/validate/${y}`;try{if(y){console.log("checked token exists");const S=await ie(c,!1,b);console.log("==>data",S),(S==null?void 0:S.status)!==200&&!(S!=null&&S.ok)?(console.log("Token not validated"),b.push("/auth/login")):console.log("no data")}else console.log("No access token"),b.push("/auth/login")}catch(S){console.log("Error validating token",S),b.push("/auth/login")}};M(async()=>{await T()});const V=i([]),P=i(0),d=i(0),m=i([]),a=i({name:"month",code:"month"}),r=i(`${E}/attendance/trends/${a==null?void 0:a.value.name}`),n=i([]),x=i([]),g=i({}),_=i("bar"),h=i(""),p=i([]),U=i(null),N=i({}),Z=i({}),K=y=>{const c=y.getDay(),$=y.getDate()-c+(c===0?-6:1);return new Date(y.setDate($))};M(async()=>{await A(b),await l(a,m),await o(V,p),await f(P),await t(d),await u(x,n,b),await k(new Date,new Date,U),await k(K(new Date),new Date,Z)}),L(()=>U.value,(y,c)=>{if(y!==c){const $=Object.keys(U.value)[0];console.log("dailyAttendance.value[dateKey]",U.value[$]),N.value=U.value[$]}}),L(()=>a.value,(y,c)=>{if(y!==c){const $=`${E}/attendance/trends/${a==null?void 0:a.value.name}`;r.value=$,v(r,g)}}),L(h,(y,c)=>{y!==c&&(y.trim()!==""?V.value=p.value.filter($=>$.name.toLowerCase().includes(y.toLowerCase())):V.value=p.value)});const R=y=>{console.log("==>linkto,",y),y==="employee"&&b.push("/employees"),y==="leaveRequets"&&b.push("/leave/request"),y==="jobPosts"&&b.push("/Jobs"),y==="attendance"&&b.push("/attendance")},H=[{name:"month",code:"month"},{name:"year",code:"year"}];return M(()=>{a.value=H[0]}),(y,c)=>{var S,G,Q,X;const $=I("Dropdown");return C(),O("div",at,[e("div",{onClick:c[0]||(c[0]=F=>R("employee")),class:"col-12 lg:col-6 xl:col-3",style:{cursor:"pointer"}},[e("div",ot,[e("div",lt,[e("div",null,[st,e("div",nt,j((S=V.value)==null?void 0:S.length),1)]),ct])])]),e("div",{onClick:c[1]||(c[1]=F=>R("leaveRequets")),class:"col-12 lg:col-6 xl:col-3"},[e("div",rt,[e("div",it,[e("div",null,[ut,e("div",dt,j(d.value),1)]),mt])])]),e("div",{onClick:c[2]||(c[2]=F=>R("jobPosts")),class:"col-12 lg:col-6 xl:col-3"},[e("div",vt,[e("div",yt,[e("div",null,[pt,e("div",_t,j(P.value),1)]),bt]),P.value&&P.value.length>0?(C(),O("span",ht,j(P.value.applicationList&&P.value.applicationList.length>0?P.value.applicationList.length:0),1)):q("",!0),P.value&&P.value.length>0?(C(),O("span",gt,"Applications")):q("",!0)])]),e("div",{onClick:c[3]||(c[3]=F=>R("attendance")),class:"col-12 lg:col-6 xl:col-3"},[e("div",ft,[xt,e("div",Ct,[e("div",kt,[e("span",At,j((G=N.value)==null?void 0:G.onTimeCount),1),Dt]),e("div",$t,[e("span",wt,j((Q=N.value)==null?void 0:Q.lateCount),1),jt]),e("div",Pt,[e("span",St,j((X=N.value)==null?void 0:X.absentCount),1),Tt])])])]),e("div",Ft,[e("div",Et,[Ot,D(Ce,{label:"Employees per Department",lables:n.value,data:x.value},null,8,["lables","data"])])]),e("div",Bt,[e("div",It,[e("div",Lt,[Vt,D($,{modelValue:a.value,"onUpdate:modelValue":c[4]||(c[4]=F=>a.value=F),options:H,optionLabel:"name",placeholder:"search employee...",class:"mr-2 ml-auto",style:{width:"8rem"}},null,8,["modelValue"])]),e("div",Ut,[e("div",null,[ae(e("input",{type:"radio",id:"bar",value:"bar","onUpdate:modelValue":c[5]||(c[5]=F=>_.value=F),class:le({"selected-radio":_.value==="bar"})},null,2),[[oe,_.value]]),Rt]),e("div",qt,[ae(e("input",{type:"radio",id:"line",value:"line","onUpdate:modelValue":c[6]||(c[6]=F=>_.value=F),class:le({"selected-radio":_.value==="line"})},null,2),[[oe,_.value]]),Mt])]),_.value==="bar"?(C(),J(we,{key:0,chartDataObject:g.value,attendanceFrame:a.value.name,url:r.value},null,8,["chartDataObject","attendanceFrame","url"])):q("",!0),_.value==="line"?(C(),J(De,{key:1,chartDataObject:g.value,attendanceFrame:a.value.name,url:r.value},null,8,["chartDataObject","attendanceFrame","url"])):q("",!0)])]),D(et,{employees:V.value,employeeSearch:h.value,"onUpdate:employeeSearch":c[7]||(c[7]=F=>h.value=F)},null,8,["employees","employeeSearch"]),D(Se,{attendanceData:Z.value},null,8,["attendanceData"])])}}},zt=se(Nt,[["__scopeId","data-v-07a1986f"]]);export{zt as default};
